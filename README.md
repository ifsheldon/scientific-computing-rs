# Scientific Computing in Rust with PyTorch

This is a project template for scientific computing in Rust with `tch-rs` and a benchmark on different frameworks.

It uses [`uv`](https://github.com/astral-sh/uv) to manage PyTorch and other Python dependencies, while Rust dependencies relies on the beloved `cargo`.

## Usage

1. Clone this repo
2. Run `uv sync`
   * If you haven't, install `uv` according to [README of `uv`](https://github.com/astral-sh/uv?tab=readme-ov-file#installation)
3. Run benchmarks `cargo run --release -- benchmark <framework>` where `<framework>` is one of `[tch, burn, nalgebra, candle, all]`.
   * This will take a couple of minutes to run
4. Run template code `cargo run --release -- run-template`

## File Explained

### Python-related

* **[`.python-version`](.python-version)** - Specifies the Python version (3.12) for this project. Used by `uv` and other Python version managers to ensure consistent Python versions across different environments.

* **[`pyproject.toml`](pyproject.toml)** - The main Python project configuration file that defines project metadata, dependencies, and build settings. It configures PyTorch installation with platform-specific sources (CPU for macOS, GPU for Linux) and sets up `uv` as the package manager.

* **[`uv.lock`](uv.lock)** - A lock file generated by `uv` that pins the exact versions of all Python dependencies and their sub-dependencies. This ensures reproducible builds by locking dependency versions across different environments.

* **[`.venv/`](.venv/) folder** - The virtual environment directory created by `uv sync`. It contains the isolated Python environment with all project dependencies installed, keeping them separate from your system Python installation.

### Rust-related

#### Configs

* **[`.cargo/config.toml`](.cargo/config.toml)** - In this config file, we set proper `LIBTORCH` and `DYLD_LIBRARY_PATH` envars to inform `tch-rs` the right PyTorch static library for linking. Change this file if you are using a different Python interpreter from the `python 3.12` set up by `uv`.

#### `tch-rs` issues

See [FAQs](https://github.com/LaurentMazare/tch-rs?tab=readme-ov-file#faq) of `tch-rs`.

## License

[MIT](LICENSE)